version: "3"

volumes:
    database:
        driver: "local"

networks:
    app:

services:
    database:
        image: "mysql:8.2"
        restart: "no"
        environment:
            TZ: "UTC"
            MYSQL_ROOT_PASSWORD: "root"
            MYSQL_DATABASE: "opencoursematch"
            MYSQL_USER: "opencoursematch"
            MYSQL_PASSWORD: "opencoursematch"
        volumes:
            - "database:/var/lib/mysql"
        ports:
            - "3306:3306"
        networks:
            - "app"

    app:
        build:
            context: "."
            dockerfile: "Dockerfile-dev"
        restart: "no"
        environment:
            TZ: "UTC"
        volumes:
            - "./framework:/app/framework"
            - "./public:/app/public"
            - "./src:/app/src"
            - "./secrets:/app/secrets"
            - "./app-logs:/app/logs"
            - "./app-files:/app/files"
            - "./vendor:/app/vendor"
        ports:
            - "3000:80"
        networks:
            - "app"
